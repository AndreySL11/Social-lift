<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Social Lift Jump</title>
  <style>
    html,body{margin:0;padding:0;overflow:hidden;background:#111;color:#0ff;font-family:Arial, sans-serif;}
    canvas{display:block;background:linear-gradient(#004,to top,#0a0,white);}
    .screen{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;background:rgba(0,0,0,0.8);z-index:10;}
    .hidden{display:none;}
    button{padding:10px 20px;margin:10px;font-size:18px;color:#111;font-weight:bold;border:none;border-radius:8px;background:#0ff;cursor:pointer;}
    #ui{position:absolute;top:10px;left:10px;color:#fff;font-size:18px;z-index:5;}
  </style>
</head>
<body>
  <canvas id="game"></canvas>
  <div id="ui">Монеты: <span id="uiCoins">0</span> | Высота: <span id="uiHeight">0</span> м</div>

  <!-- Заставка -->
  <div id="splash" class="screen">
    <div style="font-size:48px;color:#0ff;margin-bottom:20px;text-shadow:0 0 10px #0ff;">Social Lift</div>
    <button onclick="toMenu()">Начать</button>
  </div>

  <!-- Главное меню -->
  <div id="menu" class="screen hidden">
    <div style="font-size:36px;color:#0ff;margin-bottom:20px;">Меню</div>
    <button onclick="startGame()">Играть</button>
    <button onclick="toShop()">Магазин</button>
    <button onclick="toRating()">Рейтинг</button>
  </div>

  <!-- Магазин -->
  <div id="shop" class="screen hidden">
    <div style="font-size:28px;color:#0ff;margin-bottom:10px;">Магазин</div>
    <div>Монеты: <span id="shopCoins">0</span></div>
    <button onclick="buySkin()">Купить скин (100 SL)</button>
    <button onclick="buyBooster()">Купить усилитель (50 SL)</button>
    <button onclick="toMenu()">Назад</button>
  </div>

  <!-- Рейтинг -->
  <div id="rating" class="screen hidden">
    <div style="font-size:28px;color:#0ff;margin-bottom:10px;">Рейтинг</div>
    <ul id="ratingList" style="margin-bottom:20px;"></ul>
    <button onclick="toMenu()">Назад</button>
  </div>

  <!-- Конец игры -->
  <div id="gameover" class="screen hidden">
    <div style="font-size:32px;color:#0ff;margin-bottom:20px;">Игра окончена</div>
    <div>Высота: <span id="finalHeight">0</span> м</div>
    <div>Монеты: <span id="earnedCoins">0</span></div>
    <button onclick="restart()">Играть заново</button>
    <button onclick="toMenu()">В меню</button>
  </div>

<script>
// == ПЕРЕМЕННЫЕ ==
const canvas = document.getElementById('game'), ctx = canvas.getContext('2d');
let W = window.innerWidth, H = window.innerHeight; canvas.width = W; canvas.height = H;
const UI_coins = document.getElementById('uiCoins'), UI_height = document.getElementById('uiHeight');
const screens = { splash:document.getElementById('splash'), menu:document.getElementById('menu'), shop:document.getElementById('shop'), rating:document.getElementById('rating'), gameover:document.getElementById('gameover') };
const shopCoinsEl = document.getElementById('shopCoins'), ratingList = document.getElementById('ratingList');
const finalHeightEl = document.getElementById('finalHeight'), earnedCoinsEl = document.getElementById('earnedCoins');

let coins = parseInt(localStorage.getItem('coins')||'0');
let bestScore = parseInt(localStorage.getItem('bestScore')||'0');
let boosters = parseInt(localStorage.getItem('boosters')||'0');
let skin = localStorage.getItem('skinChosen')||'#0ff';

let gameRunning=false, score=0, player, platforms=[], enemies=[], isTouch=false, touchX=0;

// == УТИЛИТЫ ==
function showScreen(name){ for(let s in screens) screens[s].classList.add('hidden'); screens[name].classList.remove('hidden'); }
function toMenu(){ showScreen('menu'); updateUI(); }
function toShop(){ shopCoinsEl.innerText=coins; showScreen('shop'); }
function toRating(){
  ratingList.innerHTML=`<li>Лучший: ${Math.floor(bestScore/100)} м</li>`;
  showScreen('rating');
}
function buySkin(){ if(coins>=100){ coins-=100; skin = '#f00'; localStorage.setItem('skinChosen',skin); localStorage.setItem('coins',coins); shopCoinsEl.innerText=coins; updateUI(); alert('Куплено скин!'); }}
function buyBooster(){ if(coins>=50){ coins-=50; boosters++; localStorage.setItem('boosters',boosters); localStorage.setItem('coins',coins); shopCoinsEl.innerText=coins; updateUI(); alert('Куплен усилитель!'); }}
function updateUI(){ UI_coins.innerText=coins; UI_height.innerText=Math.floor(score/100); }

// == ИГРА ==
class Player {
  constructor(){ this.x=W/2; this.y=H-50; this.vy=0; this.r=20; }
  update(){
    this.vy += 0.5;
    this.y += this.vy;
    if(this.y>H){ endGame(); }
    platforms.forEach(p=>{
      let py = H - (score - p.y);
      if(this.vy>0 && this.y+this.r>py && this.y+this.r<py+10 && this.x>p.x && this.x<p.x+p.w){
        this.vy = -(boosterJump?15:12); boosterJump=false;
      }
    });
    if(this.y<H/2){
      score+=H/2-this.y;
      this.y = H/2;
    }
  }
  draw(){
    ctx.fillStyle=skin;
    ctx.beginPath(); ctx.arc(this.x,this.y,this.r,0,2*Math.PI); ctx.fill();
    if(boosters>0){
      ctx.strokeStyle='#ff0'; ctx.lineWidth=3;
      ctx.beginPath(); ctx.arc(this.x,this.y,this.r+4,0,2*Math.PI); ctx.stroke();
    }
  }
}

function genPlatforms(){
  platforms=[];
  let y=H-30;
  for(let i=0;i<20;i++){
    platforms.push({ x:Math.random()*(W-80), y:i*100, w:80 });
  }
}

let boosterJump=false;
function startGame(){
  showScreen(''); // спрячь все
  gameRunning=true; score=0; boosterJump=false;
  player=new Player(); enemies=[]; boosters=boosters; genPlatforms(); updateUI();
}

function endGame(){
  gameRunning=false;
  showScreen('gameover');
  finalHeightEl.innerText=Math.floor(score/100);
  let earned = Math.floor(score/100);
  coins+= boosters>0?earned*2:earned;
  earnedCoinsEl.innerText= boosters>0?(earned*2):earned;
  if(score>bestScore){ bestScore=score; localStorage.setItem('bestScore',bestScore); }
  localStorage.setItem('coins',coins);
  updateUI();
}

function restart(){ startGame(); }

function gameLoop(){
  if(gameRunning){
    ctx.clearRect(0,0,W,H);
    player.update(); player.draw();
    platforms.forEach(p=>{
      ctx.fillStyle='#654321';
      ctx.fillRect(p.x, H-(score-p.y), p.w,10);
    });
    updateUI();
  }
  requestAnimationFrame(gameLoop);
}

window.addEventListener('resize',()=>{ W=window.innerWidth; H=window.innerHeight; canvas.width=W; canvas.height=H; });
window.addEventListener('touchstart',e=>{ isTouch=true; touchX=e.touches[0].clientX; player.x=touchX; boosterJump=true; });
window.addEventListener('touchend',()=>{ isTouch=false; });
window.addEventListener('mousemove',e=>{ if(isTouch){ player.x=e.clientX; }});

showScreen('splash');
gameLoop();
</script>
</body>
</html>





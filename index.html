<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=320, initial-scale=1" />
  <title>Social Lift Jump</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      font-family: 'Montserrat', sans-serif;
      user-select: none;
      color: #fff;
    }
    canvas {
      display: block;
      margin: 0 auto;
      background: #102a43;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(255,255,255,0.2);
    }
    #ui {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 320px;
      display: flex;
      justify-content: space-between;
      font-size: 20px;
      font-weight: 600;
      text-shadow: 0 0 5px #000;
      pointer-events: none;
      z-index: 100;
    }
    button {
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      font-size: 20px;
      padding: 12px 24px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 15px #1e3c72;
      background-color: #2a5298;
      color: white;
      margin: 5px;
      transition: background-color 0.3s ease;
      user-select: none;
      pointer-events: auto;
      z-index: 200;
    }
    button:hover {
      background-color: #1e3c72;
    }
    #menu, #gameOverScreen {
      position: fixed;
      top: 50%;
      left: 50%;
      width: 320px;
      padding: 20px;
      border-radius: 16px;
      background: rgba(16, 42, 67, 0.95);
      box-shadow: 0 0 30px #0f2241;
      transform: translate(-50%, -50%);
      text-align: center;
      color: #fff;
      z-index: 150;
      user-select: none;
      display: none;
      pointer-events: auto;
    }
    #menu.active, #gameOverScreen.active {
      display: block;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="320" height="480"></canvas>
  <div id="ui">
    <div>Высота: <span id="score">0</span> м</div>
    <div>Монеты SL: <span id="coins">0</span></div>
  </div>
  <div id="menu" class="active">
    <h2>Social Lift Jump</h2>
    <button id="startGameBtn">Начать игру</button>
  </div>
  <div id="gameOverScreen">
    <h2>Игра окончена</h2>
    <p>Ваш результат: <span id="finalScore">0</span> м</p>
    <p>Монеты: <span id="finalCoins">0</span></p>
    <button id="restartGameBtn">Начать заново</button>
    <button id="goToMenuBtn1">В меню</button>
  </div>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const width = canvas.width;
  const height = canvas.height;

  const scoreEl = document.getElementById('score');
  const coinsEl = document.getElementById('coins');
  const menu = document.getElementById('menu');
  const startGameBtn = document.getElementById('startGameBtn');
  const gameOverScreen = document.getElementById('gameOverScreen');
  const finalScoreEl = document.getElementById('finalScore');
  const finalCoinsEl = document.getElementById('finalCoins');
  const restartGameBtn = document.getElementById('restartGameBtn');
  const goToMenuBtn1 = document.getElementById('goToMenuBtn1');

  let player = {
    x: width / 2 - 18,
    y: height - 140,
    width: 36,
    height: 36,
    vy: 0,
    vx: 0,
    gravity: 0.35,
    jumpForce: -10,
    color: '#FFD700',
  };
  let platforms = [];
  const platformGap = 50;
  let scrollOffset = 0;
  let gameOver = false;
  let coinsCount = 0;
  let playerCoins = parseInt(localStorage.getItem('playerCoins')) || 0;

  function createPlatforms() {
    platforms = [];
    platforms.push({x: width/2 - 50, y: height - 100, w: 100, h: 15});
    let y = height - 150;
    while (y > -2000) {
      let x = Math.random() * (width - 80);
      platforms.push({x, y, w: 80, h: 15, coin: Math.random() < 0.35, coinCollected: false});
      y -= platformGap + Math.random() * 20;
    }
  }

  function drawPlayer() {
    ctx.fillStyle = player.color;
    ctx.fillRect(player.x, player.y, player.width, player.height);
  }

  function updatePlayer() {
    player.vy += player.gravity;
    player.y += player.vy;
    player.x += player.vx;

    if(player.x + player.width < 0) player.x = width;
    else if(player.x > width) player.x = -player.width;

    for(let plat of platforms) {
      if(
        player.vy > 0 &&
        player.x + player.width > plat.x &&
        player.x < plat.x + plat.w &&
        player.y + player.height > plat.y &&
        player.y + player.height < plat.y + plat.h
      ) {
        player.y = plat.y - player.height;
        player.vy = player.jumpForce;
        if(plat.coin && !plat.coinCollected) {
          plat.coinCollected = true;
          coinsCount += 1;
          playerCoins += 1;
          localStorage.setItem('playerCoins', playerCoins);
          updateCoinsUI();
        }
        break;
      }
    }

    if(player.y > height) {
      gameOver = true;
      endGame();
    }
  }

  function drawPlatforms() {
    for(let plat of platforms) {
      ctx.fillStyle = '#00BFFF';
      ctx.fillRect(plat.x, plat.y, plat.w, plat.h);
      if(plat.coin && !plat.coinCollected) {
        const cx = plat.x + plat.w/2;
        const cy = plat.y - 10;
        ctx.fillStyle = '#FFD700';
        ctx.beginPath();
        ctx.arc(cx, cy, 8, 0, Math.PI*2);
        ctx.fill();
        ctx.fillStyle = '#333';
        ctx.font = 'bold 10px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText('SL', cx, cy);
      }
    }
  }

  function gameLoop() {
    if(gameOver) return;
    ctx.clearRect(0, 0, width, height);
    updatePlayer();

    if(player.y < height/2) {
      let diff = (height/2) - player.y;
      player.y += diff;
      platforms.forEach(p => p.y += diff);
      scrollOffset += diff;
      coinsCount = Math.max(0, Math.floor(scrollOffset/10));
      scoreEl.textContent = coinsCount;
    }

    drawPlatforms();
    drawPlayer();

    player.vx = 0;

    requestAnimationFrame(gameLoop);
  }

  function updateCoinsUI() {
    coinsEl.textContent = playerCoins;
  }

  function startGame() {
    gameOver = false;
    scrollOffset = 0;
    coinsCount = 0;
    player.x = width/2 - 18;
    player.y = height - 140;
    player.vx = 0;
    player.vy = 0;
    createPlatforms();
    updateCoinsUI();
    scoreEl.textContent = '0';
    coinsEl.textContent = playerCoins;
    menu.classList.remove('active');
    gameOverScreen.classList.remove('active');
    requestAnimationFrame(gameLoop);
  }

  function endGame() {
    finalScoreEl.textContent = coinsCount;
    finalCoinsEl.textContent = coinsCount;
    menu.classList.remove('active');
    gameOverScreen.classList.add('active');
  }

  // Прыжок по тапу
  canvas.addEventListener('click', () => {
    if(gameOver) return;
    player.vy = player.jumpForce;
  });
  canvas.addEventListener('touchstart', e => {
    e.preventDefault();
    if(gameOver) return;
    player.vy = player.jumpForce;
  }, { passive: false });

  startGameBtn.addEventListener('click', startGame);
  restartGameBtn.addEventListener('click', startGame);
  goToMenuBtn1.addEventListener('click', () => {
    gameOverScreen.classList.remove('active');
    menu.classList.add('active');
  });

  updateCoinsUI();
});
</script>
</body>
</html>

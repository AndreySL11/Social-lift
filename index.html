<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Social Lift Jump</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #87cefa;
      font-family: 'Arial', sans-serif;
      user-select: none;
      touch-action: none;
    }

    canvas {
      display: block;
      background: linear-gradient(to top, #87cefa, #ffffff);
    }

    #ui {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      text-align: center;
      color: #000;
      font-size: 20px;
      z-index: 10;
    }

    .menu, .game-over, .shop, .ranking {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.95);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 20;
    }

    .menu button, .game-over button, .shop button, .ranking button {
      margin: 10px;
      padding: 15px 30px;
      font-size: 18px;
      background: #000;
      color: #fff;
      border: none;
      border-radius: 10px;
    }

    .coins {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 18px;
      background: #fff;
      padding: 5px 10px;
      border-radius: 10px;
    }
  </style>
</head>
<body>
<canvas id="game" width="480" height="800"></canvas>
<div id="ui">
  <div class="coins">Монеты: <span id="coinCount">0</span></div>
</div>

<div class="menu" id="mainMenu">
  <h1 style="font-size: 32px;">Social Lift</h1>
  <button onclick="startGame()">Играть</button>
  <button onclick="showShop()">Магазин</button>
  <button onclick="showRanking()">Рейтинг</button>
</div>

<div class="shop" id="shop" style="display: none;">
  <h2>Магазин</h2>
  <p>Скины и бустеры</p>
  <button onclick="buyItem('skin1', 50)">Скин 1 (50 монет)</button>
  <button onclick="buyItem('booster1', 30)">Бустер +1 прыжок (30 монет)</button>
  <button onclick="closeShop()">Назад</button>
</div>

<div class="ranking" id="ranking" style="display: none;">
  <h2>Рейтинг</h2>
  <p>1. @testuser — 1234 м</p>
  <p>2. @playerX — 1020 м</p>
  <p>3. @you — 990 м</p>
  <button onclick="closeRanking()">Назад</button>
</div>

<div class="game-over" id="gameOver" style="display: none;">
  <h2>Игра окончена</h2>
  <p>Вы набрали: <span id="finalScore">0</span> м</p>
  <button onclick="restartGame()">Играть снова</button>
</div>

<script>
  const canvas = document.getElementById("game");
  const ctx = canvas.getContext("2d");
  let player, platforms, coins, enemies;
  let score = 0;
  let coinCount = parseInt(localStorage.getItem("coins")) || 0;
  let gameRunning = false;
  let keys = { left: false, right: false };
  let gravity = 0.4, jumpStrength = -10;
  let scrollY = 0;
  let night = false;

  function init() {
    player = {
      x: 240,
      y: 700,
      width: 40,
      height: 40,
      vy: 0,
      color: "black"
    };
    platforms = [{ x: 200, y: 740, width: 80, height: 10 }];
    coins = [];
    enemies = [];
    score = 0;
    scrollY = 0;
    updateCoinDisplay();
  }

  function updateCoinDisplay() {
    document.getElementById("coinCount").textContent = coinCount;
  }

  function drawPlayer() {
    ctx.fillStyle = player.color;
    ctx.fillRect(player.x, player.y - scrollY, player.width, player.height);
  }

  function drawPlatforms() {
    ctx.fillStyle = "green";
    for (let p of platforms) {
      ctx.fillRect(p.x, p.y - scrollY, p.width, p.height);
    }
  }

  function drawCoins() {
    ctx.fillStyle = "gold";
    for (let c of coins) {
      ctx.beginPath();
      ctx.arc(c.x, c.y - scrollY, 5, 0, Math.PI * 2);
      ctx.fill();
    }
  }

  function drawEnemies() {
    ctx.fillStyle = "red";
    for (let e of enemies) {
      ctx.fillRect(e.x, e.y - scrollY, e.width, e.height);
    }
  }

  function update() {
    if (!gameRunning) return;

    player.vy += gravity;
    player.y += player.vy;

    if (keys.left) player.x -= 5;
    if (keys.right) player.x += 5;

    // Коллизии с платформами
    for (let p of platforms) {
      if (player.vy > 0 &&
        player.x + player.width > p.x &&
        player.x < p.x + p.width &&
        player.y + player.height >= p.y &&
        player.y + player.height <= p.y + p.height) {
        player.vy = jumpStrength;
      }
    }

    // Сбор монет
    coins = coins.filter(c => {
      const collected = player.x < c.x + 10 && player.x + player.width > c.x &&
        player.y < c.y + 10 && player.y + player.height > c.y;
      if (collected) {
        coinCount++;
        localStorage.setItem("coins", coinCount);
        updateCoinDisplay();
      }
      return !collected;
    });

    // Столкновение с врагом
    for (let e of enemies) {
      if (player.x < e.x + e.width && player.x + player.width > e.x &&
        player.y < e.y + e.height && player.y + player.height > e.y) {
        endGame();
      }
    }

    if (player.y < 400) {
      const dy = 400 - player.y;
      scrollY += dy;
      player.y = 400;
      score += Math.round(dy / 10);
    }

    // Генерация новых платформ и монет
    const lastY = Math.min(...platforms.map(p => p.y));
    while (lastY - 100 > player.y - scrollY - 800) {
      const px = Math.random() * 400;
      const py = lastY - 80;
      platforms.push({ x: px, y: py, width: 80, height: 10 });
      if (Math.random() < 0.3) coins.push({ x: px + 40, y: py - 10 });
      if (Math.random() < 0.1) enemies.push({ x: px + 20, y: py - 20, width: 30, height: 30 });
    }

    // Падение
    if (player.y - scrollY > 800) endGame();
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    if (night) ctx.fillStyle = "#000033"; else ctx.fillStyle = "#87cefa";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    drawPlatforms();
    drawCoins();
    drawEnemies();
    drawPlayer();
    ctx.fillStyle = "#000";
    ctx.fillText(`Высота: ${score} м`, 10, 20);
    requestAnimationFrame(() => {
      if (gameRunning) {
        update();
        draw();
      }
    });
  }

  function startGame() {
    document.getElementById("mainMenu").style.display = "none";
    init();
    gameRunning = true;
    draw();
  }

  function endGame() {
    gameRunning = false;
    document.getElementById("finalScore").textContent = score;
    document.getElementById("gameOver").style.display = "flex";
  }

  function restartGame() {
    document.getElementById("gameOver").style.display = "none";
    startGame();
  }

  function showShop() {
    document.getElementById("mainMenu").style.display = "none";
    document.getElementById("shop").style.display = "flex";
  }

  function closeShop() {
    document.getElementById("shop").style.display = "none";
    document.getElementById("mainMenu").style.display = "flex";
  }

  function showRanking() {
    document.getElementById("mainMenu").style.display = "none";
    document.getElementById("ranking").style.display = "flex";
  }

  function closeRanking() {
    document.getElementById("ranking").style.display = "none";
    document.getElementById("mainMenu").style.display = "flex";
  }

  function buyItem(item, cost) {
    if (coinCount >= cost) {
      coinCount -= cost;
      localStorage.setItem("coins", coinCount);
      updateCoinDisplay();
      alert(`Куплено: ${item}`);
    } else {
      alert("Недостаточно монет");
    }
  }

  document.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") keys.left = true;
    if (e.key === "ArrowRight") keys.right = true;
  });

  document.addEventListener("keyup", e => {
    if (e.key === "ArrowLeft") keys.left = false;
    if (e.key === "ArrowRight") keys.right = false;
  });

  // Touch управление
  let touchX = null;
  document.addEventListener("touchstart", e => {
    touchX = e.touches[0].clientX;
  });
  document.addEventListener("touchmove", e => {
    const dx = e.touches[0].clientX - touchX;
    keys.left = dx < -10;
    keys.right = dx > 10;
  });

  // День/ночь каждые 10 секунд
  setInterval(() => night = !night, 10000);
</script>
</body>
</html>



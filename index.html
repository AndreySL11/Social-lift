<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Social Lift Jump</title>
  <style>
    body, html { margin:0;padding:0;overflow:hidden;font-family:Montserrat,sans-serif;background:#000; color:#fff; }
    #canvas { display:block; background:#102a43; margin:0 auto; }
    .overlay { position:absolute; top:0; left:0; width:100%; height:100%; display:flex; align-items:center; justify-content:center; flex-direction:column; }
    button { margin:10px; padding:15px 30px; font-size:20px; cursor:pointer; border:none; border-radius:8px; background:#1e88e5; color:#fff; }
    button:hover { background:#1565c0 }
    #shop, #scoreboard { display:none; }
    .item { margin:5px 0; }
  </style>
</head>
<body>

<canvas id="canvas" width="360" height="640"></canvas>

<!-- Меню -->
<div id="menu" class="overlay">
  <h1 style="font-size:48px;color:#1e88e5;">Social Lift</h1>
  <button onclick="startGame()">Играть</button>
  <button onclick="openShop()">Магазин</button>
  <button onclick="openScoreboard()">Рейтинг</button>
</div>

<!-- Магазин -->
<div id="shop" class="overlay">
  <h2>Магазин</h2>
  <div id="shopItems"></div>
  <button onclick="saveState();backToMenu()">⬅ Назад</button>
</div>

<!-- Рейтинг -->
<div id="scoreboard" class="overlay">
  <h2>Рейтинг</h2>
  <div id="scoresList"></div>
  <button onclick="backToMenu()">⬅ Назад</button>
</div>

<script>
const canvas = document.getElementById('canvas'), c=canvas.getContext('2d');
const W=canvas.width, H=canvas.height;
const gravity=0.3, playerSize=40, maxBoost=5;
let gameOver=false, scroll=0, coins=0, platforms=[], player, boostTime=0, boostMode="none";

const skins=[ {name:'Жёлтый', color:'#FFD700', price:0}, {name:'Синий', color:'#2196f3', price:50}, {name:'Зелёный', color:'#4caf50', price:50} ];
const boosts=[ {name:'Усиленный прыжок', effect:'jump', price:100}, {name:'Щит', effect:'shield', price:200} ];

function loadState(){
  coins=+localStorage.coins||0;
  const boughtSkins=JSON.parse(localStorage.boughtSkins||'[]');
  skins.forEach(s=>s.bought=boughtSkins.includes(s.name));
  boostMode=localStorage.boostMode||"none";
  playerSkinIndex=+localStorage.playerSkinIndex||0;
}
function saveState(){
  localStorage.coins=coins;
  localStorage.boughtSkins=JSON.stringify(skins.filter(s=>s.bought).map(s=>s.name));
  localStorage.boostMode=boostMode;
  localStorage.playerSkinIndex=playerSkinIndex;
}
loadState();

let playerSkinIndex=+localStorage.playerSkinIndex||0;

function setupShop(){
  const div=document.getElementById('shopItems'); div.innerHTML='';
  skins.forEach((s,i)=>{
    const btn=document.createElement('button');
    btn.textContent=`${s.name} — ${s.price} SL`;
    btn.disabled=s.bought;
    btn.onclick=()=>{
      if(coins>=s.price){ coins-=s.price; s.bought=true; playerSkinIndex=i; saveState(); setupShop(); }
    };
    const wrap=document.createElement('div'); wrap.className='item';
    wrap.appendChild(btn);
    div.appendChild(wrap);
  });
  boosts.forEach(b=>{
    const btn=document.createElement('button');
    btn.textContent=`${b.name} — ${b.price} SL`;
    btn.onclick=()=>{
      if(coins>=b.price){ coins-=b.price; boostTime=1000; boostMode=b.effect; saveState(); setupShop(); }
    };
    const wrap=document.createElement('div'); wrap.className='item';
    wrap.appendChild(btn);
    div.appendChild(wrap);
  });
}
setupShop();

function saveScore(){
  const name=prompt("Ник для рейтинга:","Player")||"Player";
  const list=JSON.parse(localStorage.scores||'[]');
  list.push({name, score: Math.floor(scroll)});
  list.sort((a,b)=>b.score-a.score);
  localStorage.scores=JSON.stringify(list.slice(0,10));
}

function openShop(){
  document.getElementById('menu').style.display='none';
  setupShop();
  document.getElementById('shop').style.display='flex';
}
function openScoreboard(){
  document.getElementById('menu').style.display='none';
  const div=document.getElementById('scoresList');
  const list=JSON.parse(localStorage.scores||'[]');
  div.innerHTML=list.map(e=>`${e.name}: ${e.score} м`).join('<br>');
  document.getElementById('scoreboard').style.display='flex';
}
function backToMenu(){
  document.getElementById('shop').style.display='none';
  document.getElementById('scoreboard').style.display='none';
  document.getElementById('menu').style.display='flex';
}

function startGame(){
  document.getElementById('menu').style.display='none';
  initGame();
  requestAnimationFrame(loop);
}

function initGame(){
  player={x:W/2,y:H-100,vx:0,vy:0};
  scroll=0; gameOver=false;
  platforms=[{x:W/2-60,y:H-20,w:120,h:10}];
  for(let i=0;i<5;i++) genPlatform(H-100-120*i);
}

function genPlatform(y){
  platforms.push({x:Math.random()*(W-80),y,w:80,h:10, moving:Math.random()<0.3, dir:1});
}

function loop(){
  c.clearRect(0,0,W,H);
  // фон
  c.fillStyle='#102a43'; c.fillRect(0,0,W,H);

  // ввод
  player.vx=0;
  canvas.onpointerdown=e=>{
    const dir = (e.clientX<W/2?-1:1); player.vx = dir*3;
  };
  canvas.onpointerup=()=>player.vx=0;

  // физика
  player.x+=player.vx;
  player.vy+=gravity*(boostMode==='jump'?0.6:1);
  player.y+=player.vy;

  if(player.x<0)player.x=W;
  if(player.x>W)player.x=0;

  // платфомы
  platforms.forEach(p=>{
    if(p.moving){ p.x+=p.dir*1; if(p.x<0||p.x+80>W)p.dir*=-1;}
    if(player.vy>0 && player.x+playerSize>p.x && player.x< p.x+p.w && player.y+playerSize>p.y && player.y+playerSize< p.y+p.h+player.vy){
      player.vy=boostMode==='jump'? -14 : -8;
      coins++;
    }
    c.fillStyle='#1e88e5'; c.fillRect(p.x,p.y,p.w,p.h);
  });

  // скролл
  if(player.y<H/3){
    const d=(H/3)-player.y; player.y=H/3;
    platforms.forEach(p=>p.y+=d);
    scroll+=d;
  }
  platforms=platforms.filter(p=>p.y<H);
  while(platforms.length<6) genPlatform(-10);

  // игрок
  c.fillStyle=skins[playerSkinIndex].color;
  c.fillRect(player.x,player.y,playerSize,playerSize);

  // HUD
  c.fillStyle='#fff'; c.fillText(`Монеты: ${coins}`,10,20);
  c.fillText(`Высота: ${Math.floor(scroll)}`,10,40);

  if(player.y>H){
    gameOver=true; saveState();
    saveScore();
    openScoreboard();
    return;
  }

  requestAnimationFrame(loop);
}

</script>
</body>
</html>




